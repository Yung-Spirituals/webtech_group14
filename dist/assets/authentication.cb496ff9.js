function h(n,o,s,t){g("POST","https://gr14.appdev.cloudns.ph/authenticate/login",function(e){a("jwt",e.jwt);const i=p(e.jwt);i&&(a("current_username",i.username),a("current_user_roles",i.roles.join(","))),s()},{username:n,password:o},function(e){t(e)})}function l(n){const s=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(s).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)}function p(n){let o=null;const s=l(n);return s&&(o={username:s.sub,roles:s.roles.map(t=>t.authority)}),o}function w(){console.log("Logging out..."),d()}function d(){u("jwt"),u("current_username"),u("current_user_roles")}function a(n,o,s){const t=new Date;t.setTime(t.getTime()+s*24*60*60*1e3);let r="expires="+t.toUTCString();document.cookie=n+"="+o+";"+r+";path=/"}function u(n){a(n,"",-1)}function f(n){let o=n+"=",t=decodeURIComponent(document.cookie).split(";");for(let r=0;r<t.length;r++){let e=t[r];for(;e.charAt(0)===" ";)e=e.substring(1);if(e.indexOf(o)===0)return e.substring(o.length,e.length)}return""}function g(n,o,s,t,r){const e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(e.status===200){let c="";e.responseText&&(c=JSON.parse(e.responseText)),s(c)}else r?r(e.responseText):console.error("Error in API request")},e.open(n,o);const i=f("jwt");i&&e.setRequestHeader("Authorization","Bearer "+i),t?n.toLowerCase()!=="get"?(e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(t))):(console.error("Trying to send request data with HTTP GET, not allowed!"),e.send()):e.send()}export{w as d,f as g,h as s};
